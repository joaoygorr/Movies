name: Pull Request

on: [pull_request]

jobs:
    install:
        name: Instaliing Packages
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Cache node_modules
              uses: actions/cache@v4
              with:
                  path: node_modules
                  key: ${{runner.os}}-${{hashFiles('**/yarn.lock')}}

            - name: Install Dependencies
              run: yarn

    unusedExports:
        name: Find unused exports (dead code)
        runs-on: ubuntu-latest
        needs: install
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Restore node_modules
              uses: actions/cache@v4
              with:
                  path: node_modules
                  key: ${{runner.os}}-${{hashFiles('**/yarn.lock')}}

            - name: Run ts-prune
              run: yarn find-deadcode
